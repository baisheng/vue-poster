!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e=e||self).vuePoster={},e.Vue)}(this,(function(e,t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function n(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{d(o.next(e))}catch(e){i(e)}}function a(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}d((o=o.apply(e,t||[])).next())}))}function o(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var r=(t=t&&t.hasOwnProperty("default")?t.default:t).extend({name:"vue-poster-loading",props:{color:String,backgroundColor:String}});var i,s=function(e,t,n,o,r,i,s,a,d,l){"boolean"!=typeof s&&(d=a,a=s,s=!1);var u,c="function"==typeof n?n.options:n;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),o&&(c._scopeId=o),i?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=u):t&&(u=s?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),u)if(c.functional){var f=c.render;c.render=function(e,t){return u.call(t),f(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,u):[u]}return n},a="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var d={};var l=function(e){return function(e,t){return function(e,t){var n=a?t.media||"default":e,o=d[n]||(d[n]={ids:new Set,styles:[]});if(!o.ids.has(e)){o.ids.add(e);var r=t.source;if(t.map&&(r+="\n/*# sourceURL="+t.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",t.media&&o.element.setAttribute("media",t.media),void 0===i&&(i=document.head||document.getElementsByTagName("head")[0]),i.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(r),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{var s=o.ids.size-1,l=document.createTextNode(r),u=o.element.childNodes;u[s]&&o.element.removeChild(u[s]),u.length?o.element.insertBefore(l,u[s]):o.element.appendChild(l)}}}(e,t)}};const u=r;var c=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"v-poster-loading",style:{backgroundColor:this.backgroundColor}},[t("div",{staticClass:"v-poster-loading__icon",style:{color:this.color}})])};c._withStripped=!0;var f=s({render:c,staticRenderFns:[]},(function(e){e&&e("data-v-ac6a49dc_0",{source:"\n.v-poster-loading {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n}\n.v-poster-loading__icon {\n  color: #bdbdbd;\n}\n.v-poster-loading__icon,\n.v-poster-loading__icon:after {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 16px;\n  height: 16px;\n  border: 2px solid currentColor;\n  border-top-color: transparent;\n  border-radius: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-animation: VPosterLoading 0.4s linear infinite;\n          animation: VPosterLoading 0.4s linear infinite;\n}\n@-webkit-keyframes VPosterLoading {\n0% { -webkit-transform: translate(-50%, -50%) rotate(0deg); transform: translate(-50%, -50%) rotate(0deg);\n}\n100% { -webkit-transform: translate(-50%, -50%) rotate(360deg); transform: translate(-50%, -50%) rotate(360deg);\n}\n}\n@keyframes VPosterLoading {\n0% { -webkit-transform: translate(-50%, -50%) rotate(0deg); transform: translate(-50%, -50%) rotate(0deg);\n}\n100% { -webkit-transform: translate(-50%, -50%) rotate(360deg); transform: translate(-50%, -50%) rotate(360deg);\n}\n}\n",map:void 0,media:void 0})}),u,void 0,!1,void 0,l,void 0),p=new(function(){function e(){this.events={}}return e.prototype.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this.events[e]||[];o.forEach((function(e){e.apply(null,t)}))},e}()),m=document.createElement("canvas"),v=m.getContext("2d"),h=1;function g(e,t){var n=new Image;return t&&(n.crossOrigin="anonymous"),new Promise((function(t){n.onload=function(){return t(n)},n.onerror=function(){return console.warn("[vue-poster]: Failed to load image at "+e)},n.src=e}))}var b=function(e){var t=e.offsetX,n=void 0===t?0:t,o=e.offsetY,r=void 0===o?0:o,i=e.text,s=e.color,a=void 0===s?"black":s,d=e.font,l=void 0===d?"normal 400 14px sans-serif":d;return v.fillStyle=a,v.font=l,v.textBaseline="top",v.fillText(i,n,r),new Promise((function(e){return e()}))};const y=t.extend({name:"vue-poster",props:{posterClass:String,width:Number,height:Number,ratio:Number,type:String,quality:Number,backgroundColor:String},data:function(){return{isPosterDrwaCompleted:!1,elements:[],imageDate:""}},components:{Loading:f},beforeMount:function(){var e=this;p.on("mounted",(function(t){return e.elements.push(t)}))},mounted:function(){return n(this,void 0,void 0,(function(){var e,t,r;return o(this,(function(i){switch(i.label){case 0:!function(e){var t=e.width,n=void 0===t?300:t,o=e.height,r=void 0===o?300:o,i=e.ratio,s=void 0===i?1:i,a=e.backgroundColor;h=s,m.width=n*h,m.height=r*h,v.scale(h,h),"string"==typeof a&&(v.fillStyle=a,v.fillRect(0,0,n*h,r*h))}({width:this.width,height:this.height,ratio:this.ratio,backgroundColor:this.backgroundColor}),e=0,i.label=1;case 1:return e<this.elements.length?"image"!==(t=this.elements[e]).type?[3,3]:[4,(d={src:t.vm.src,offsetX:t.vm.offsetX,offsetY:t.vm.offsetY,width:t.vm.width,height:t.vm.height,cors:t.vm.cors},n(void 0,void 0,void 0,(function(){var e,t,n,r,i,s,a,l,u,c,f;return o(this,(function(o){switch(o.label){case 0:return e=d.width,t=d.height,n=d.offsetX,r=void 0===n?0:n,i=d.offsetY,s=void 0===i?0:i,a=d.src,l=d.cors,[4,g(a,void 0!==l&&l)];case 1:return u=o.sent(),c=e||u.width/h,f=t||u.height/h,v.drawImage(u,r,s,c,f),[2,new Promise((function(e){return e()}))]}}))})))]:[3,6];case 2:return i.sent(),[3,5];case 3:return"text"!==t.type?[3,5]:(r=t.vm.$slots.default[0].text||"",[4,b({offsetX:t.vm.offsetX,offsetY:t.vm.offsetY,color:t.vm.color,text:r.trim(),font:t.vm.font})]);case 4:i.sent(),i.label=5;case 5:return e++,[3,1];case 6:return this.imageDate=(s=this.type,a=this.quality,m.toDataURL("png"===s?"image/png":"image/jpeg",a||1)),this.isPosterDrwaCompleted=!0,[2]}var s,a,d}))}))}});var w=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"v-poster-wrapper"},[this.isPosterDrwaCompleted?t("img",{class:this.posterClass,attrs:{src:this.imageDate}}):this._t("loading",[t("Loading")]),this._v(" "),this._t("default")],2)};w._withStripped=!0;var _=s({render:w,staticRenderFns:[]},(function(e){e&&e("data-v-9080ab4a_0",{source:"\n.v-poster-wrapper {\n  position: relative;\n  display: flex;\n}\n",map:void 0,media:void 0})}),y,void 0,!1,void 0,l,void 0),x=function(e){return{mounted:function(){p.emit("mounted",{type:e,vm:this})},destroyed:function(){p.emit("unmounted",{type:e,vm:this})}}};var C=s({},void 0,t.extend({name:"vue-poster-image",mixins:[x("image")],props:{width:Number,height:Number,offsetY:Number,offsetX:Number,src:String,cors:{type:Boolean,default:!1}},render:function(e){return e()}}),void 0,void 0,void 0,void 0,void 0);var k=s({},void 0,t.extend({name:"vue-poster-text",mixins:[x("text")],props:{width:Number,height:Number,offsetY:Number,offsetX:Number,color:String,font:String},render:function(e){return e()}}),void 0,void 0,void 0,void 0,void 0);"undefined"!=typeof window&&window.Vue&&(t.component("poster",_),t.component("poster-image",C),t.component("poster-text",k),t.component("poster-loading",f)),e.Poster=_,e.PosterImage=C,e.PosterLoading=f,e.PosterText=k,Object.defineProperty(e,"__esModule",{value:!0})}));
