!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e=e||self).VuePoster={},e.Vue)}(this,(function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var n=function(e){return console.warn("[vue-poster]: "+e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function o(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{d(o.next(e))}catch(e){i(e)}}function s(e){try{d(o.throw(e))}catch(e){i(e)}}function d(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(a,s)}d((o=o.apply(e,t||[])).next())}))}function r(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var i=t.extend({name:"poster-loading",props:{color:String,backgroundColor:String}});var a,s=function(e,t,n,o,r,i,a,s,d,u){"boolean"!=typeof a&&(d=s,s=a,a=!1);var l,c="function"==typeof n?n.options:n;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),o&&(c._scopeId=o),i?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=l):t&&(l=a?function(){t.call(this,u(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),l)if(c.functional){var f=c.render;c.render=function(e,t){return l.call(t),f(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,l):[l]}return n},d="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var u={};var l=function(e){return function(e,t){return function(e,t){var n=d?t.media||"default":e,o=u[n]||(u[n]={ids:new Set,styles:[]});if(!o.ids.has(e)){o.ids.add(e);var r=t.source;if(t.map&&(r+="\n/*# sourceURL="+t.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",t.media&&o.element.setAttribute("media",t.media),void 0===a&&(a=document.head||document.getElementsByTagName("head")[0]),a.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(r),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{var i=o.ids.size-1,s=document.createTextNode(r),l=o.element.childNodes;l[i]&&o.element.removeChild(l[i]),l.length?o.element.insertBefore(s,l[i]):o.element.appendChild(s)}}}(e,t)}};const c=i;var f=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"v-poster-loading",style:{backgroundColor:this.backgroundColor}},[t("div",{staticClass:"v-poster-loading__icon",style:{color:this.color}})])};f._withStripped=!0;var p=s({render:f,staticRenderFns:[]},(function(e){e&&e("data-v-b281b21c_0",{source:"\n.v-poster-loading {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.7);\n}\n.v-poster-loading__icon {\n  color: #bdbdbd;\n}\n.v-poster-loading__icon,\n.v-poster-loading__icon:after {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 16px;\n  height: 16px;\n  border: 2px solid currentColor;\n  border-top-color: transparent;\n  border-radius: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-animation: VPosterLoading 0.4s linear infinite;\n          animation: VPosterLoading 0.4s linear infinite;\n}\n@-webkit-keyframes VPosterLoading {\n0% { -webkit-transform: translate(-50%, -50%) rotate(0deg); transform: translate(-50%, -50%) rotate(0deg);\n}\n100% { -webkit-transform: translate(-50%, -50%) rotate(360deg); transform: translate(-50%, -50%) rotate(360deg);\n}\n}\n@keyframes VPosterLoading {\n0% { -webkit-transform: translate(-50%, -50%) rotate(0deg); transform: translate(-50%, -50%) rotate(0deg);\n}\n100% { -webkit-transform: translate(-50%, -50%) rotate(360deg); transform: translate(-50%, -50%) rotate(360deg);\n}\n}\n",map:void 0,media:void 0})}),c,void 0,!1,void 0,l,void 0);"undefined"!=typeof window&&window.Vue&&t.component("poster-loading",p);var h=document.createElement("canvas"),m=h.getContext("2d"),v=1;const g=t.extend({name:"poster",props:{posterClass:String,width:Number,height:Number,ratio:Number,type:String,quality:Number,backgroundColor:String},data:function(){return{elements:[],imageDate:""}},components:{Loading:p},methods:{drawPoster:function(){var e,t;this.imageDate=(e=this.type,t=this.quality,h.toDataURL("png"===e?"image/png":"image/jpeg",t||1))}},watch:{elements:function(e){return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:t=0,n.label=1;case 1:return t<e.length?[4,e[t](h,m)]:[3,4];case 2:n.sent(),n.label=3;case 3:return t++,[3,1];case 4:return this.drawPoster(),[2]}}))}))}},created:function(){var e=this;this.$on("on-poster-element-mounted",(function(t){e.elements.push(t)}))},mounted:function(){var e,t,n,o,r,i,a,s;e={width:this.width,height:this.height,ratio:this.ratio,backgroundColor:this.backgroundColor},t=e.width,n=void 0===t?300:t,o=e.height,r=void 0===o?300:o,i=e.ratio,a=void 0===i?1:i,s=e.backgroundColor,v=a,h.width=n*v,h.height=r*v,m.scale(v,v),"string"==typeof s&&(m.fillStyle=s,m.fillRect(0,0,n*v,r*v))}});var w=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"v-poster-wrapper"},[this.imageDate?t("img",{class:this.posterClass,attrs:{src:this.imageDate}}):this._t("loading",[t("Loading")]),this._v(" "),this._t("default")],2)};w._withStripped=!0;var b=s({render:w,staticRenderFns:[]},void 0,g,void 0,!1,void 0,void 0,void 0);"undefined"!=typeof window&&window.Vue&&t.component("poster",b);var y=function(e,t,n,o){var r=(e.$parent.$children||[]).filter((function(e){return e.$options.name===t}));r[0]&&r[0].$emit.apply(r[0],[n,o])};function _(e,t){var o=new Image;return t&&(o.crossOrigin="anonymous"),new Promise((function(t){o.onload=function(){return t(o)},o.onerror=function(){return n("Failed to load image at "+e)},o.src=e}))}var x=s({},void 0,t.extend({name:"poster-image",props:{width:Number,height:Number,offsetY:Number,offsetX:Number,src:String,cors:{type:Boolean,default:!1}},mounted:function(){var e=this;y(this,"poster","on-poster-element-mounted",(function(t,n){return function(e,t,n){return o(void 0,void 0,void 0,(function(){var t,o,i,a,s,d,u,l,c,f,p;return r(this,(function(r){switch(r.label){case 0:return t=e.width,o=e.height,i=e.offsetX,a=void 0===i?0:i,s=e.offsetY,d=void 0===s?0:s,u=e.src,l=e.cors,[4,_(u,void 0!==l&&l)];case 1:return c=r.sent(),f=t||c.width/v,p=o||c.height/v,n.drawImage(c,a,d,f,p),[2,new Promise((function(e){return e()}))]}}))}))}({width:e.width,height:e.height,offsetX:e.offsetX,offsetY:e.offsetY,src:e.src,cors:e.cors},0,n)}))},render:function(e){return e()}}),void 0,void 0,void 0,void 0,void 0);"undefined"!=typeof window&&window.Vue&&t.component("poster-image",x);var C=s({},void 0,t.extend({name:"poster-text",props:{width:Number,height:Number,offsetY:Number,offsetX:Number,color:String,font:String},mounted:function(){var e=this,t=this.$slots.default&&this.$slots.default[0].text||"";y(this,"poster","on-poster-element-mounted",(function(n,o){return function(e){var t=e.offsetX,n=void 0===t?0:t,o=e.offsetY,r=void 0===o?0:o,i=e.text,a=e.color,s=void 0===a?"black":a,d=e.font,u=void 0===d?"normal 400 14px sans-serif":d;return m.fillStyle=s,m.font=u,m.textBaseline="top",m.fillText(i,n,r),new Promise((function(e){return e()}))}({offsetX:e.offsetX,offsetY:e.offsetY,color:e.color,font:e.font,text:t.trim()})}))},render:function(e){return e()}}),void 0,void 0,void 0,void 0,void 0);"undefined"!=typeof window&&window.Vue&&t.component("poster-text",C),"undefined"==typeof window&&n("You are using a whole package, please use https://www.npmjs.com/package/babel-plugin-import to reduce app bundle size."),e.Poster=b,e.PosterImage=x,e.PosterLoading=p,e.PosterText=C,Object.defineProperty(e,"__esModule",{value:!0})}));
